<!doctype html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Twitch配信者追加</title>
    <style>
      :root {
        --bg-color: #ffffff;
        --text-color: #111111;
        --card-border: #ddd;
        --card-bg: #ffffff;
        --input-border: #ccc;
        --input-bg: #ffffff;
        --button-bg: #f0f0f0;
        --button-text: #111111;
        --table-header-bg: #f2f2f2;
        --table-border: #ddd;
        --message-color: #22aa22;
        --error-color: #dd3333;
        --link-color: #007bff;
      }
      @media (prefers-color-scheme: dark) {
        :root {
          --bg-color: #1a1a1a;
          --text-color: #e0e0e0;
          --card-border: #444;
          --card-bg: #2a2a2a;
          --input-border: #555;
          --input-bg: #2a2a2a;
          --button-bg: #3a3a3a;
          --button-text: #e0e0e0;
          --table-header-bg: #333;
          --table-border: #444;
          --message-color: #66dd66;
          --error-color: #ff6666;
          --link-color: #6db3f2;
        }
      }
      body { font-family: system-ui, -apple-system, sans-serif; margin: 24px; background: var(--bg-color); color: var(--text-color); }
      .card { max-width: 720px; padding: 16px; border: 1px solid var(--card-border); border-radius: 12px; background: var(--card-bg); }
      label { display:block; margin-top: 12px; }
      input { width: 100%; padding: 10px; margin-top: 6px; border-radius: 10px; border: 1px solid var(--input-border); background: var(--input-bg); color: var(--text-color); }
      button { margin-top: 16px; padding: 10px 14px; border-radius: 10px; border: 0; cursor: pointer; background: var(--button-bg); color: var(--button-text); }
      button:hover { opacity: 0.8; }
      .message { color: var(--message-color); margin-top: 12px; }
      .error { color: var(--error-color); margin-top: 12px; }
      a { color: var(--link-color); }
      table { border-collapse: collapse; width: 100%; margin-top: 16px; }
      th { background-color: var(--table-header-bg); border: 1px solid var(--table-border); padding: 8px; text-align: left; }
      td { border: 1px solid var(--table-border); padding: 8px; }
    </style>
  </head>
  <body>
    <div class="card">
      <h1>Twitch配信者を監視対象リストに追加</h1>
      <div><ul>
        <li>追加された配信者についたコメントが今後取得されていきます</li>
        <li>即コメントが取得されるわけではありません。数時間おきに巡回し、かつ配信者が配信していないときに取得されます</li>
      </ul></div>
      <form method="post">
        <label>Twitchユーザ名またはチャンネルURL</label>
        <input type="text" name="username" required placeholder="例: fps_shaka または https://www.twitch.tv/fps_shaka">

        <button type="submit">追加</button>
      </form>

      {% if message %}
      <div class="message">{{ message }}</div>
      {% endif %}

      {% if error %}
      <div class="error">{{ error }}</div>
      {% endif %}

      <h2>現在の監視対象ユーザ</h2>
      <table>
        <thead>
          <tr>
            <th>ユーザ名</th>
            <th>ID</th>
          </tr>
        </thead>
        <tbody>
          {% for user in users %}
          <tr>
            <td><a href="https://www.twitch.tv/{{ user.name }}">{{ user.name }}</a></td>
            <td>{{ user.id }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>

      <div style="margin-top: 16px; display:flex; gap:16px;">
        <a href="{{ request.url_for('index') }}">トップに戻る</a>
        <a href="{{ request.url_for('manual_page') }}">使い方ガイド</a>
      </div>
    </div>
  </body>
</html>